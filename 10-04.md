# Домашнее задание к занятию "Основы работы с Asterisk"

### Цель задания

В результате выполнения задания вы научитесь:  

1. Установливать Asterisk на виртуальной машине
2. Настраивать учетные записи для регистрации на данном сервере
3. Настраивать простейшую маршрутизацию вызова между внутренними абонентами данной АТС

------

### Инструкция к выполнению домашнего задания

1. Сделайте копию [Шаблона для домашнего задания](https://docs.google.com/document/d/1youKpKm_JrC0UzDyUslIZW2E2bIv5OVlm_TQDvH5Pvs/edit) себе на Google Disk.
2. В названии файла введите корректное название лекции и вашу фамилию и имя.
3. Зайдите в “Настройки доступа” и выберите доступ “Просматривать могут все в Интернете, у кого есть ссылка”.  Ссылка на инструкцию [Как предоставить доступ к файлам и папкам на Google Диске](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop)
4. Скопируйте текст задания в свой документ.
5. Выполните домашнее задание, запишите ответы и приложите необходимые скриншоты в свой Google Doc.
6. Для проверки домашнего задания преподавателем отправьте ссылку на ваш документ в личном кабинете.
7. Любые вопросы по решению задач задавайте в чате учебной группы.

------

 ### Подготовка
 
 1. Скачайте текущую сертифицированную версию Asterisk [по ссылке](https://downloads.asterisk.org/pub/telephony/certified-asterisk/asterisk-certified-18.9-cert3.tar.gz)
 2. В каталоге, куда были загружены исходники, найдите и выполните скрипт по установке необходимых для Asterisk пакетов - его можно найти в каталоге /contrib/scripts/install_prereq install
 3. В каталоге, куда были загружены исходники, выполните `./configure`
 4. Выполните `make menuselect`
 5. Выберите модули cdr_odbc, cdr_adaptive_odbc, chan_sip и нажмите "Save & Exit".
 6. Выполните 'make && make install && make samples && make config && make install-logrotate'
 7. Выполните `/usr/sbin/asterisk`
 8. Подключитесь к Asterisk удаленно путём ввода команды Asterisk -rvvvv
 9. Установите [zoiper](https://www.zoiper.com/en/voip-softphone/download/current) на телефон и пк для звонков.
 
------
 
### Задание 1. Настройка учетных записей

1. В файле sip.conf настройте две учетные записи [1001] и [1002] по образцу ниже:

   [XXXX]  
  type=friend   
  secret=XXXXXXX    - *в secret должен быть указан пароль*  
  context=XXXXXX    - *в качестве context - название контекста диалплана, в котором будут обрабатывать звонки*  
  host=dynamic  
  disallow=all  
  allow=ulaw,alaw  
  nat=no  
  directmedia=no  
  qualify=yes 

   В [general] нужно определелить context по умолчанию - назовем его "from-internal"

2. После добавления данных учетных записей в файл sip.conf выполните следующую команду:  
`asterisk -rx 'sip reload'`  
3. Зарегистрируйте данные учетные записи на софтфоне (программа zoiper)

*Для проверки задания выполните команду `asterisk -rx 'sip show peers' | grep OK`  и приложите скриншот ответа команды и файл sip.conf*

------

### Задание 2. Настройка плана набора

1. В файле extensions.conf настройте обработку вызовов в контексте по умолчанию "from-internal"

    [from-internal]  
    exten => _X.,1,Dial(SIP/${EXTEN})  
    same => n,Hangup  

2. Осуществите вызов через zoiper, убедитесь, что прошел звонок.  
   Во время вызова выполните команду: 
`asterisk -rx 'core show channels verbose'`.

*Для проверки задания приложите скриншот ответа команды из п.2 и файл extensions.conf*

------

### Правила приема домашнего задания

В личном кабинете отправлены:

- ссылка на документ (Google Doc) с выполненным заданием. В документе настроены права доступа “Просматривать могут все в Интернете, у кого есть ссылка”;
- файлы в формате .conf, .png или .jpg.


### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.
